<!DOCTYPE html><html lang="pt-BR"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cadastro PIX - cashnopix</title>

  <link rel="stylesheet" href="/saque/css/styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <style>
    /* Pequena correção visual do botão para usar .register-button já existente no styles.css */
    /* Se preferir manter .botao, atualize as classes no HTML */
    /* Mantive o estilo inline mínimo aqui apenas para garantir compatibilidade */
  </style>

</head>
<body>

   <script>
  window.pixelId = "6954a38e69de19cad1767359";
  var a = document.createElement("script");
  a.setAttribute("async", "");
  a.setAttribute("defer", "");
  a.setAttribute("src", "https://cdn.utmify.com.br/scripts/pixel/pixel.js");
  document.head.appendChild(a);
</script>
<script
  src="https://cdn.utmify.com.br/scripts/utms/latest.js"
  data-utmify-prevent-xcod-sck
  data-utmify-prevent-subids
  async
  defer
></script>
    

  <header class="fixed-header">
    <div class="logo-text">cashnopix</div>
    <div class="saldo-button">
      <span id="currentSaldo">R$ 202,09</span>
    </div>
  </header>

  <div class="progress-container">
    <p class="progress-label">Seu progresso</p>
    <div class="progress-bar">
      <div class="progress-fill" style="width: 75%;"></div>
    </div>
  </div>

  <main class="main-content">
    <div class="saldo-display">
      <p class="saldo-label">Seu saldo</p>
      <p class="saldo-valor">R$ 202,09</p>
    </div>

    <div class="pix-key-selection">
      <p class="selection-title">Selecione seu tipo de chave PIX</p>

      <div class="key-options">
        <button class="key-button selected" data-key-type="cpf" id="btnCpf">
          <i class="fas fa-user-circle"></i>
          CPF
        </button>

        <button class="key-button" data-key-type="telefone" id="btnTelefone">
          <i class="fas fa-phone-alt"></i>
          Telefone
        </button>
      </div>
    </div>

    <div class="key-input-container">
      <input type="text" id="keyInput" class="key-input" placeholder="Digite seu CPF (apenas números)" aria-label="Digite sua chave PIX" maxlength="14">
      <p id="hint" style="margin-top:8px;color:#888;font-size:0.9rem;">Formato: 000.000.000-00</p>
    </div>

    <!-- Botão agora é <button> e usa a classe register-button do seu CSS (já definida em styles.css) -->
    <button id="registerBtn" class="register-button" disabled="" style="opacity: 0.6; pointer-events: none;">CADASTRAR PIX</button>

  </main>

  <script>
  const btnCpf = document.getElementById('btnCpf');
  const btnTelefone = document.getElementById('btnTelefone');
  const keyInput = document.getElementById('keyInput');
  const registerBtn = document.getElementById('registerBtn');
  const hint = document.getElementById('hint');
  let currentType = 'cpf';

  function selectType(type) {
    currentType = type;
    if (type === 'cpf') {
      btnCpf.classList.add('selected');
      btnTelefone.classList.remove('selected');
      keyInput.value = '';
      keyInput.placeholder = 'Digite seu CPF (apenas números)';
      keyInput.maxLength = 14;
      hint.textContent = 'Formato: 000.000.000-00';
    } else {
      btnTelefone.classList.add('selected');
      btnCpf.classList.remove('selected');
      keyInput.value = '';
      keyInput.placeholder = 'Digite seu Telefone (DD + número)';
      keyInput.maxLength = 16;
      hint.textContent = 'Formato: (XX) XXXXX-XXXX';
    }
    updateButtonState();
  }

  btnCpf.addEventListener('click', () => selectType('cpf'));
  btnTelefone.addEventListener('click', () => selectType('telefone'));

  function onlyDigits(str) { return str.replace(/\D/g, ''); }
  function maskCPF(value) {
    const v = onlyDigits(value).slice(0,11);
    return v.replace(/(\d{3})(\d{3})(\d{3})(\d{0,2})/, (_,a,b,c,d)=>d?`${a}.${b}.${c}-${d}`:c?`${a}.${b}.${c}`:b?`${a}.${b}`:a);
  }
  function maskPhone(value) {
    const v = onlyDigits(value).slice(0,11);
    if (v.length <= 2) return '('+v;
    if (v.length <= 6) return '('+v.slice(0,2)+') '+v.slice(2);
    if (v.length <= 10) return '('+v.slice(0,2)+') '+v.slice(2,6)+'-'+v.slice(6);
    return '('+v.slice(0,2)+') '+v.slice(2,7)+'-'+v.slice(7);
  }

  function validateCPF(raw) {
    const cpf = onlyDigits(raw);
    if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;
    const calc = (t) => {
      let sum = 0;
      for (let i = 0; i < t - 1; i++) sum += cpf[i] * (t - i);
      const d = 11 - (sum % 11);
      return d >= 10 ? 0 : d;
    };
    return calc(10) == cpf[9] && calc(11) == cpf[10];
  }

  function validatePhone(raw) {
    const p = onlyDigits(raw);
    return p.length >= 10 && p.length <= 11;
  }

  keyInput.addEventListener('input', (e) => {
    e.target.value = currentType === 'cpf' ? maskCPF(e.target.value) : maskPhone(e.target.value);
    updateButtonState();
  });

  function updateButtonState() {
    const value = keyInput.value.trim();
    const valid = currentType === 'cpf' ? validateCPF(value) : validatePhone(value);
    registerBtn.disabled = !valid;
    registerBtn.style.opacity = valid ? '1' : '0.6';
    registerBtn.style.pointerEvents = valid ? 'auto' : 'none';
  }

  keyInput.addEventListener('blur', () => {
    const value = keyInput.value.trim();
    if (!value) return;
    const valid = currentType === 'cpf' ? validateCPF(value) : validatePhone(value);
    hint.textContent = valid ? (currentType === 'cpf' ? 'CPF válido.' : 'Telefone válido.')
                             : (currentType === 'cpf' ? 'CPF inválido.' : 'Telefone inválido.');
  });

  registerBtn.addEventListener('click', (e) => {
  e.preventDefault();
  const raw = keyInput.value.trim();
  const isValid = currentType === 'cpf' ? validateCPF(raw) : validatePhone(raw);
  if (!isValid) {
    alert('Verifique os dados antes de continuar.');
    return;
  }

  // desativa o botão para evitar múltiplos cliques
  registerBtn.disabled = true;
  registerBtn.textContent = 'Cadastrando...';

  // redireciona sem parâmetros (mantém UTM scripts intactos)
  setTimeout(() => {
    (() => {
          const next = new URL("/av2", window.location.origin);
          const qs = (window.getUTMQS ? window.getUTMQS() : window.location.search);
          if (qs) next.search = qs;
          window.location.href = next.toString();
        })();
  }, 800); // pequeno delay opcional para UX
});

  selectType('cpf');
</script>

<script src="/saque/js/utm-helper.js"></script>



</body></html>
